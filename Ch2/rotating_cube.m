function rotating_cube(l, w, h)
if nargin ~= 3
    l = 5; w = 5; h = 5;
end

r = 0;
p = 0;
y = 0;

% t = timer('ExecutionMode', 'fixedRate', ...
%     'TasksToExecute', Inf, ...
%     'Period', 0.01, ...
%     'TimerFcn', {@increment_angles, l, w, h}, ...
%     'UserData', struct('roll', r, 'pitch', p, 'yaw', y));
% 
% start(t);

while true
    r = r+0.01;
    p = p+0.01;
    y = y+0.01;
    
    plot_cube(l, w, h, r, p, y);
    
    drawnow;
end

end

function plot_cube(l, w, h, r, p, y)
R = eul2r(r, p, y);
p = [[w/2; l/2; h/2], ...
      [w/2; -l/2; h/2], ...
      [w/2; l/2; -h/2], ...
      [w/2; -l/2; -h/2], ...
      [-w/2; l/2; h/2], ...
      [-w/2; -l/2; h/2], ...
      [-w/2; l/2; -h/2], ...
      [-w/2; -l/2; -h/2]];

p = R*p;

x = [[p(1,1); p(1,2)], [p(1,1); p(1,3)], [p(1,1); p(1,5)], ...
        [p(1,6); p(1,5)], [p(1,6); p(1,2)], [p(1,6); p(1,8)], ...
        [p(1,7); p(1,5)], [p(1,7); p(1,3)], [p(1,7); p(1,8)], ...
        [p(1,4); p(1,2)], [p(1,4); p(1,3)], [p(1,4); p(1,8)]];
   
y = [[p(2,1); p(2,2)], [p(2,1); p(2,3)], [p(2,1); p(2,5)], ...
        [p(2,6); p(2,5)], [p(2,6); p(2,2)], [p(2,6); p(2,8)], ...
        [p(2,7); p(2,5)], [p(2,7); p(2,3)], [p(2,7); p(2,8)], ...
        [p(2,4); p(2,2)], [p(2,4); p(2,3)], [p(2,4); p(2,8)]];
    
z = [[p(3,1); p(3,2)], [p(3,1); p(3,3)], [p(3,1); p(3,5)], ...
        [p(3,6); p(3,5)], [p(3,6); p(3,2)], [p(3,6); p(3,8)], ...
        [p(3,7); p(3,5)], [p(3,7); p(3,3)], [p(3,7); p(3,8)], ...
        [p(3,4); p(3,2)], [p(3,4); p(3,3)], [p(3,4); p(3,8)]];
   

plot3(x, y, z);
limit = max([l, w, h]);
xlim([-limit, limit]);
ylim([-limit, limit]);
zlim([-limit, limit]);
end

